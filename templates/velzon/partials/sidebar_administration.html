{% load static %}
{% load i18n %}
{% block sidebar %}
        <!-- ========== App Menu ========== -->
        <div class="app-menu navbar-menu">
            <!-- LOGO -->
            <div class="navbar-brand-box">
                <!-- Dark Logo-->
                <a href="{% url 'administration:dashboard'%}" class="logo logo-dark">
                    <span class="logo-sm">
                        <img src="{% static 'images/logo-sm.png'%}" alt="" height="22">
                    </span>
                    <span class="logo-lg">
                        <img src="{% static 'images/logo-dark.png'%}" alt="" height="17">
                    </span>
                </a>
                <!-- Light Logo-->
                <a href="{% url 'administration:dashboard'%}" class="logo logo-light">
                    <span class="logo-sm">
                        <img src="{% static 'images/logo-sm.png'%}" alt="" height="22">
                    </span>
                    <span class="logo-lg">
                        <img src="{% static 'images/logo-light.png'%}" alt="" height="17">
                    </span>
                </a>
                <button type="button" class="btn btn-sm p-0 fs-20 header-item float-end btn-vertical-sm-hover" id="vertical-hover">
                    <i class="ri-record-circle-line"></i>
                </button>
            </div>

            <div id="scrollbar">
                <div class="container-fluid">
                    
                    <div id="two-column-menu">
                    </div>
                    <ul class="navbar-nav" id="navbar-nav">
                        <li class="menu-title"><span data-key="t-menu">{% trans "Menu Administration" %}</span></li>
                        
                        <!-- Dashboard -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'administration:dashboard' %}">
                                <i class="ri-dashboard-2-line"></i> <span data-key="t-dashboard">{% trans "Tableau de Bord" %}</span>
                            </a>
                        </li>

                        <!-- Vehicle Management -->
                        <li class="nav-item">
                            <a class="nav-link menu-link collapsed" href="#sidebarVehicles" data-bs-toggle="collapse" role="button"
                                aria-expanded="false" aria-controls="sidebarVehicles">
                                <i class="ri-car-line"></i> <span data-key="t-vehicles">{% trans "Gestion des Véhicules" %}</span>
                            </a>
                            <div class="collapse menu-dropdown" id="sidebarVehicles">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item">
                                        <a href="{% url 'administration:admin_vehicle_list' %}" class="nav-link" data-key="t-vehicle-list">
                                            <i class="ri-list-check me-2"></i>{% trans "Liste des Véhicules" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:admin_vehicle_create' %}" class="nav-link" data-key="t-add-vehicle">
                                            <i class="ri-add-circle-line me-2"></i>{% trans "Ajouter un Véhicule" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:advanced_vehicle_search' %}" class="nav-link" data-key="t-advanced-search">
                                            <i class="ri-search-line me-2"></i>{% trans "Recherche Avancée" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:vehicle_type_list' %}" class="nav-link" data-key="t-vehicle-types">
                                            <i class="ri-list-settings-line me-2"></i>{% trans "Types de Véhicules" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:vehicle_document_list' %}" class="nav-link" data-key="t-vehicle-documents">
                                            <i class="ri-file-list-3-line me-2"></i>{% trans "Documents des Véhicules" %}
                                        </a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </li>

                        <!-- Contraventions Management -->
                        <li class="nav-item">
                            <a class="nav-link menu-link collapsed" href="#sidebarContraventions" data-bs-toggle="collapse" role="button"
                                aria-expanded="false" aria-controls="sidebarContraventions">
                                <i class="ri-file-list-3-line"></i> <span data-key="t-contraventions">{% trans "Gestion des Contraventions" %}</span>
                            </a>
                            <div class="collapse menu-dropdown" id="sidebarContraventions">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:list' %}" class="nav-link" data-key="t-contravention-list">
                                            <i class="ri-list-check me-2"></i>{% trans "Liste des Contraventions" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:create' %}" class="nav-link" data-key="t-create-contravention">
                                            <i class="ri-add-circle-line me-2"></i>{% trans "Créer une Contravention" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:admin_contestation_list' %}" class="nav-link" data-key="t-contestations">
                                            <i class="ri-discuss-line me-2"></i>{% trans "Contestations" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:admin_infraction_list' %}" class="nav-link" data-key="t-infractions">
                                            <i class="ri-error-warning-line me-2"></i>{% trans "Types d'Infractions" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:admin_report_dashboard' %}" class="nav-link" data-key="t-reports">
                                            <i class="ri-bar-chart-line me-2"></i>{% trans "Rapports et Statistiques" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:admin_configuration' %}" class="nav-link" data-key="t-configuration">
                                            <i class="ri-settings-3-line me-2"></i>{% trans "Configuration" %}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>

                        <!-- Fourrière Management -->
                        <li class="nav-item">
                            <a class="nav-link menu-link collapsed" href="#sidebarFourriere" data-bs-toggle="collapse" role="button"
                                aria-expanded="false" aria-controls="sidebarFourriere">
                                <i class="ri-building-line"></i> <span data-key="t-fourriere">{% trans "Gestion de la Fourrière" %}</span>
                            </a>
                            <div class="collapse menu-dropdown" id="sidebarFourriere">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:fourriere_list' %}" class="nav-link" data-key="t-fourriere-list">
                                            <i class="ri-list-check me-2"></i>{% trans "Dossiers en Fourrière" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'contraventions:list' %}" class="nav-link" data-key="t-create-fourriere">
                                            <i class="ri-add-circle-line me-2"></i>{% trans "Créer un Dossier" %}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>

                        <!-- Price Grids -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'administration:price_grid_list' %}">
                                <i class="ri-grid-line"></i> <span data-key="t-price-grids">{% trans "Grilles Tarifaires" %}</span>
                            </a>
                        </li>

                        <!-- Users Management -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'administration:user_list' %}">
                                <i class="ri-user-settings-line"></i> <span data-key="t-users">{% trans "Utilisateurs" %}</span>
                            </a>
                        </li>

                        <!-- Payment Management -->
                        <li class="nav-item">
                            <a class="nav-link menu-link collapsed" href="#sidebarPayments" data-bs-toggle="collapse" role="button"
                                aria-expanded="false" aria-controls="sidebarPayments">
                                <i class="ri-money-dollar-circle-line"></i> <span data-key="t-payments">{% trans "Gestion des Paiements" %}</span>
                            </a>
                            <div class="collapse menu-dropdown" id="sidebarPayments">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item">
                                        <a href="{% url 'administration:payment_management' %}" class="nav-link" data-key="t-payment-list">
                                            <i class="ri-list-check me-2"></i>{% trans "Liste des Paiements" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:payment_gateways' %}" class="nav-link" data-key="t-payment-gateways">
                                            <i class="ri-bank-card-line me-2"></i>{% trans "Passerelles de Paiement" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'administration:stripe_config_manage' %}" class="nav-link" data-key="t-stripe-settings">
                                            <i class="ri-settings-3-line me-2"></i>{% trans "Paramètres Stripe" %}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>

                        <!-- Cash Payment System (Admin) -->
                        <li class="nav-item">
                            <a class="nav-link menu-link collapsed" href="#sidebarCashAdmin" data-bs-toggle="collapse" role="button"
                                aria-expanded="false" aria-controls="sidebarCashAdmin">
                                <i class="ri-hand-coin-line"></i> <span data-key="t-cash-admin">{% trans "Gestion Espèces" %}</span>
                            </a>
                            <div class="collapse menu-dropdown" id="sidebarCashAdmin">
                                <ul class="nav nav-sm flex-column">
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_collector_list' %}" class="nav-link" data-key="t-collectors">
                                            <i class="ri-user-star-line me-2"></i>{% trans "Agents Partenaires" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_approval_list' %}" class="nav-link" data-key="t-approvals">
                                            <i class="ri-checkbox-circle-line me-2"></i>{% trans "Approbations" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_reconciliation' %}" class="nav-link" data-key="t-reconciliation">
                                            <i class="ri-calculator-line me-2"></i>{% trans "Réconciliation" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_collection_report' %}" class="nav-link" data-key="t-collection-report">
                                            <i class="ri-file-chart-line me-2"></i>{% trans "Rapport de Collecte" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_commission_report' %}" class="nav-link" data-key="t-commission-report">
                                            <i class="ri-percent-line me-2"></i>{% trans "Rapport Commissions" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_discrepancy_report' %}" class="nav-link" data-key="t-discrepancy-report">
                                            <i class="ri-alert-line me-2"></i>{% trans "Rapport Écarts" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_audit_trail' %}" class="nav-link" data-key="t-audit-trail">
                                            <i class="ri-shield-check-line me-2"></i>{% trans "Piste d'Audit" %}
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'payments:admin_system_config' %}" class="nav-link" data-key="t-system-config">
                                            <i class="ri-settings-4-line me-2"></i>{% trans "Configuration Système" %}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>

                        <!-- Analytics -->
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'administration:analytics' %}">
                                <i class="ri-bar-chart-line"></i> <span data-key="t-analytics">{% trans "Analytiques" %}</span>
                            </a>
                        </li>

                        <!-- Audit Logs removed: unified under dashboard -->

                        <!-- User Profile -->
                        <li class="menu-title"><i class="ri-more-fill"></i> <span data-key="t-account">{% trans "Mon Compte" %}</span></li>
                        
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'core:velzon_dashboard' %}">
                                <i class="ri-dashboard-line"></i> <span data-key="t-main-dashboard">{% trans "Tableau de Bord Principal" %}</span>
                            </a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'core:profile' %}">
                                <i class="ri-user-line"></i> <span data-key="t-profile">{% trans "Profil" %}</span>
                            </a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link menu-link" href="{% url 'core:logout' %}">
                                <i class="ri-logout-box-line"></i> <span data-key="t-logout">{% trans "Déconnexion" %}</span>
                            </a>
                        </li>

                    </ul>
                </div>
                <!-- Sidebar -->
            </div>
            <div class="sidebar-background"></div>
        </div>
        <!-- Left Sidebar End -->
        <!-- Vertical Overlay-->
        <div class="vertical-overlay"></div>

        <!-- Sidebar Menu JavaScript -->
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Bootstrap collapse for sidebar menus
            const menuLinks = document.querySelectorAll('.nav-link[data-bs-toggle="collapse"]');
            
            menuLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        // Close other open menus
                        const allMenus = document.querySelectorAll('.menu-dropdown');
                        allMenus.forEach(function(menu) {
                            if (menu !== targetElement && menu.classList.contains('show')) {
                                menu.classList.remove('show');
                                const menuLink = document.querySelector('[href="#' + menu.id + '"]');
                                if (menuLink) {
                                    menuLink.classList.add('collapsed');
                                    menuLink.setAttribute('aria-expanded', 'false');
                                }
                            }
                        });
                        
                        // Toggle current menu
                        if (targetElement.classList.contains('show')) {
                            targetElement.classList.remove('show');
                            this.classList.add('collapsed');
                            this.setAttribute('aria-expanded', 'false');
                        } else {
                            targetElement.classList.add('show');
                            this.classList.remove('collapsed');
                            this.setAttribute('aria-expanded', 'true');
                        }
                    }
                });
            });
        });
        </script>
{% endblock sidebar %}
















